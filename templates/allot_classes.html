{% extends "base.html" %}

{% block title %}Allot Classes - Lumen ERP{% endblock %}

{% block content %}
<div class="nm-card" style="max-width: 1200px; margin: 40px auto; padding: 40px; min-height: 80vh;">
    <div style="margin-bottom: 50px;">
        <h1 class="hero-text" style="margin-bottom: 10px;">Allot Classes</h1>
        <p style="color: var(--text-secondary); font-weight: 700;">Assign faculty members to their classes and subjects.
        </p>
    </div>

    <div class="nm-inset" style="margin-bottom: 60px; padding: 50px; border-radius: var(--radius-xl);">
        <h2
            style="font-weight: 900; margin-bottom: 30px; letter-spacing: -1px; display: flex; align-items: center; gap: 15px;">
            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="var(--accent-color)" stroke-width="3">
                <path d="M4 19.5A2.5 2.5 0 0 1 6.5 17H20"></path>
                <path d="M6.5 2H20v20H6.5A2.5 2.5 0 0 1 4 19.5v-15A2.5 2.5 0 0 1 6.5 2z"></path>
            </svg>
            Assign Class
        </h2>

        <form action="/admin/allot_class" method="POST">
            <div class="grid-2" style="gap: 30px; margin-bottom: 30px;">
                <div>
                    <label
                        style="display: block; margin-bottom: 10px; font-weight: 800; font-size: 0.75rem; text-transform: uppercase; color: var(--text-secondary);">Select
                        Faculty ID</label>
                    <select name="faculty_id" class="nm-input" required>
                        {% for f in faculties %}
                        <option value="{{ f.id }}">{{ f.user.username }} ({{ f.designation }})</option>
                        {% endfor %}
                    </select>
                </div>
                <div>
                    <label
                        style="display: block; margin-bottom: 10px; font-weight: 800; font-size: 0.75rem; text-transform: uppercase; color: var(--text-secondary);">Faculty
                        Name</label>
                    <input type="text" name="faculty_name" class="nm-input" placeholder="e.g. Dr. John Doe" required>
                </div>
            </div>

            <div class="grid-3" style="margin-bottom: 40px; gap: 20px;">
                <div>
                    <label
                        style="display: block; margin-bottom: 10px; font-weight: 800; font-size: 0.75rem; text-transform: uppercase; color: var(--text-secondary);">Subject</label>
                    <input type="text" name="subject" class="nm-input" placeholder="e.g. Computer Science" required>
                </div>
                <div>
                    <label
                        style="display: block; margin-bottom: 10px; font-weight: 800; font-size: 0.75rem; text-transform: uppercase; color: var(--text-secondary);">Department</label>
                    <input type="text" name="department" class="nm-input" placeholder="e.g. IT Dept" required>
                </div>
                <div>
                    <label
                        style="display: block; margin-bottom: 10px; font-weight: 800; font-size: 0.75rem; text-transform: uppercase; color: var(--text-secondary);">Class
                        Name</label>
                    <input type="text" name="class_name" class="nm-input" placeholder="e.g. Final Year B.E" required>
                </div>
            </div>

            <button type="submit" class="nm-btn"
                style="width: 100%; padding: 20px; background: var(--surface-color); box-shadow: var(--nm-btn-hover);">Assign
                Faculty</button>
        </form>
    </div>

    <div class="nm-table-container">
        <div style="padding: 20px 10px 40px;">
            <h2 style="font-weight: 900; letter-spacing: -1px;">Active Allotments</h2>
        </div>

        <table>
            <thead>
                <tr>
                    <th>Faculty Name</th>
                    <th>Username</th>
                    <th>Department</th>
                    <th>Subject</th>
                    <th>Class</th>
                    <th style="text-align: right;">Actions</th>
                </tr>
            </thead>
            <tbody>
                {% for allotment in allotments %}
                <tr>
                    <td style="font-weight: 800; color: var(--text-primary);">{{ allotment.faculty_name or 'N/A' }}</td>
                    <td style="opacity: 0.7; font-weight: 700;">{{ allotment.faculty.user.username }}</td>
                    <td style="opacity: 0.7; font-weight: 700;">{{ allotment.department }}</td>
                    <td style="color: var(--accent-color); font-weight: 800;">{{ allotment.subject }}</td>
                    <td><span class="nm-badge">{{ allotment.class_name }}</span></td>
                    <td style="text-align: right;">
                        <a href="/hod/allot_class/delete/{{ allotment.id }}" class="nm-badge"
                            style="color: #ff4757; text-decoration: none; font-weight: 800;"
                            onclick="return confirm('Remove this faculty assignment?')">Remove</a>
                    </td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
    </div>
</div>
{% endblock %}